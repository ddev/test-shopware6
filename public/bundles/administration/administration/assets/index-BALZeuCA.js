const M=`{% block sw_desktop %} <div class="sw-desktop" :class="desktopClasses" > <div v-if="isStaging" class="sw-staging-bar" > {{ $tc('global.sw-desktop.stagingBarText') }} </div> {% block sw_desktop_sidebar %} <sw-admin-menu v-if="!noNavigation" /> {% endblock %} {% block sw_desktop_content %} <div class="sw-desktop__content"> {% block sw_desktop_content_view %} <sw-error-boundary> <router-view /> </sw-error-boundary> {% endblock %} </div> <sw-app-shop-id-change-modal v-if="shopIdCheck !== null" :shop-id-check="shopIdCheck" @modal-close="closeModal" /> <sw-settings-services-grant-permissions-modal /> {% endblock %} <sw-sidebar-renderer /> </div> {% endblock %}`,{hasOwnProperty:b}=Shopware.Utils.object,C={template:M,inject:["feature","shopIdChangeService","userActivityApiService"],data(){return{noNavigation:!1,shopIdCheck:null}},computed:{desktopClasses(){return{"sw-desktop--no-nav":this.noNavigation,"sw-desktop--staging":this.isStaging}},currentUser(){return Shopware.Store.get("session").currentUser},isStaging(){var e;return((e=Shopware.Store.get("context").app.config.settings)==null?void 0:e.enableStagingMode)===!0}},watch:{$route(){this.checkRouteSettings()},"$route.name":{handler(e,s){s===void 0||e===s||this.onUpdateSearchFrequently()},immediate:!0}},created(){this.createdComponent()},methods:{createdComponent(){this.checkRouteSettings(),this.updateShopIdChangeModal()},checkRouteSettings(){this.$route.meta&&b(this.$route.meta,"noNav")?this.noNavigation=this.$route.meta.noNav:this.noNavigation=!1},async updateShopIdChangeModal(){var e;if(!((e=Shopware.Store.get("context").app.config.settings)!=null&&e.appsRequireAppUrl)){this.shopIdCheck=null;return}this.shopIdCheck=await this.shopIdChangeService.checkShopId()},closeModal(){this.shopIdCheck=null},onUpdateSearchFrequently(){var n;const e=this.getModuleMetadata();if(!e||!((n=e==null?void 0:e.route)!=null&&n.name))return!1;const s={key:`${e.name}@${e.route.name}`,cluster:this.currentUser.id};return this.userActivityApiService.increment(s)},getModuleMetadata(){var p,u,g,m,k,v,f;const{$module:e}=this.$route.meta,s=(p=this.$route)==null?void 0:p.name;if(!e)return!1;const{name:n,icon:h,color:r,entity:i,routes:t,title:d}=e;if(!this.$te(d)||!(t!=null&&t.index))return!1;const l=this.getModuleMetadataWithSearchMatcher(e,s);if(l){const{components:a,children:w,meta:o,props:S,...c}=l.route;return{...l,route:c}}if(((u=t==null?void 0:t.index)==null?void 0:u.name)===s||(m=(g=t.index)==null?void 0:g.children)!=null&&m.some(a=>a.name===s)){const{components:a,children:w,meta:o,props:S,...c}=t.index;return{name:n,icon:h,color:r,title:d,entity:i,privilege:o==null?void 0:o.privilege,route:c}}if(((k=t==null?void 0:t.create)==null?void 0:k.name)===s||(f=(v=t.create)==null?void 0:v.children)!=null&&f.some(a=>a.name===s)){const{components:a,children:w,meta:o,props:S,...c}=t.create;return{name:n,icon:h,color:r,entity:i,privilege:o==null?void 0:o.privilege,route:c,action:!0}}return!1},getModuleMetadataWithSearchMatcher(e,s){if(typeof e.searchMatcher!="function")return!1;const{title:n}=e;return e.searchMatcher(new RegExp(`^${this.$tc(n).toLowerCase()}(.*)`),this.$tc(n,2),e).find(r=>{var i,t;return r.route.name===s||((t=(i=r.route)==null?void 0:i.children)==null?void 0:t.some(d=>d.name===s))})}}};export{C as default};
